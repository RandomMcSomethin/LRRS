<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_red_idle</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>prt_entity</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();
global.inventory[0] = -1;
global.inventory[1] = -1;
global.inventory[2] = -1;
global.inventory[3] = -1;
global.inventory[4] = -1;
global.inventory[5] = -1;
global.inventory[6] = -1;
global.inventory[7] = -1;
grounded = true;
wallsliding = false;
slid = false;
currentemptyslot = 0;
currentslot = 0;
collecting = false;
collecteditem = 0;
collecteditemname = "Testing";
collecteditemdescription = "1, 2, 3";
textcache = "This message shouldn't appear.  ";
didyoudothething = false;
fading = false;
fadetime = 255;
healthbarSize = 101;
items = 0;
maxitems = 8;
full = false;
x1 = view_xview[0];
x2 = x1 + view_wview[0];
y1 = view_yview[0];
y2 = y1 + 64;
bustedyallready = false;
j = maxitems;
useitem = -1;
hollered = false;
jumptimer = 0;
maxjumptimer = 10;
runtimer = 0;
maxruntimer = 70;
boosted = false;
shinesparkstored = false;
shinesparking = false;
ssdir = 0;
sstimer = 0;
maxsstimer = 600;
sspart = part_type_create();
part_type_sprite(sspart, sprite_index, image_index, 0, 0);
part_type_scale(sspart, image_xscale, 1);
part_type_alpha2(sspart, 0.5, 0);
part_type_life(sspart, 30, 30);
timer = 0;
sliding = false;
slidetimer = -1;
maxslidetimer = 15;
timer = 0;
footAngle = 270;

shoottimer = 0;
maxshoottimer = 2;
firerate = 5;
weaponspr = spr_pp;
bulletlimit = 5;
bullet = obj_peashooterbullet;

camera = instance_create(x, y, obj_camera);

idlespr = spr_red_idle;
runspr = spr_redrun;
jumpspr = spr_red_jump;
fallspr = spr_red_fall;
smearspr = spr_red_smearshoot;
shootspr = spr_red_shoot;
jumpshootspr = spr_red_jumpshoot;
fallshootspr = spr_red_fallshoot;
runshootspr = spr_redrunshoot;
wallslidespr = spr_red_slide;
hurtspr = spr_red_hurt;
deadspr = spr_red_dead;
framenum = 0;
runFrame[0] = 0;
runFrame[1] = 3;
runAlt = 0;
image_speed = 60/13;

speedBooster = false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();
part_type_sprite(sspart, sprite_index, image_index, 0, 0);

//Inventory
r = keyboard_check(vk_right);
l = -keyboard_check(vk_left);
j = keyboard_check_pressed(ord("X"));
j2 = keyboard_check(ord("X"));
s = keyboard_check(vk_lshift);
ss = keyboard_check(vk_down);
u = keyboard_check(vk_up);
shoot = keyboard_check(ord("Z"));
inspect = keyboard_check(ord("C"));
one = keyboard_check(ord("1"));
two = keyboard_check(ord("2"));
three = keyboard_check(ord("3"));
four = keyboard_check(ord("4"));
five = keyboard_check(ord("5"));
six = keyboard_check(ord("6"));
seven = keyboard_check(ord("7"));
eight = keyboard_check(ord("8"));

//Jumps and Gravity
normalmaxgrav = 9.8;
maxgrav = normalmaxgrav;
if (!j2) { jumptimer = maxjumptimer;}
if (!boosted &amp;&amp; !sliding) {
    if (grounded) { maxxspeed = 4.0; jumptimer = 0;}
    else { maxxspeed = 2.0; }
}
g = maxgrav/20;

//Speed booster/shinespark
part_type_scale(sspart, image_xscale, 1);
image_speed = 15/60;
if (s == 1) { maxxspeed = 5.0; }

//Why is this here? 
background_x[0] = lerp(-50, room_width - background_width[0] + 50, view_xview[0]/(room_width-view_wview[0]))/2;
background_y[0] = lerp(-50, room_height - background_height[0] + 50, view_yview[0]/(room_height-view_hview[0]))/2;
timer++; 

//Boosting/Shinesparking
if (speedBooster) { //Player *must* have the Speed Booster for this to work!  
    if (maxruntimer == runtimer) { boosted = true; } else { boosted = false; }
    if (ss &amp;&amp; boosted) shinesparkstored = true;
    if (boosted) { maxxspeed = 8.0; }
}
if (!shinesparking &amp;&amp; !sliding) {
    if (r &amp;&amp; xspeed &lt; maxxspeed) { xspeed += maxxspeed/4; }
    if ((l == -1) &amp;&amp; xspeed &gt; -maxxspeed) { xspeed -= maxxspeed/4; }
    if (!r &amp;&amp; l != -1) { xspeed = xspeed/maxxspeed;}
    if (shoot &amp;&amp; shinesparkstored) { shinesparking = true; }
    image_speed = image_speed*abs(xspeed/5);
}

//Animation/Boosting
if (!shinesparking) {
if (r == 1 &amp;&amp; l != -1) {
    if (shoot == 0) {
        if(sprite_index != runspr &amp;&amp; !boosted &amp;&amp; !sliding &amp;&amp; grounded) { sprite_index = runspr;}
    } else {
        if(sprite_index != runshootspr &amp;&amp; !boosted &amp;&amp; !sliding &amp;&amp; grounded) { sprite_index = runshootspr;}
    }
    image_xscale = 1;
    if (s == 1) { image_speed = 2/6; }
    if (runtimer &lt; maxruntimer &amp;&amp; grounded &amp;&amp; !(place_meeting(x+xspeed,y - 1,obj_wall))) runtimer++;
}
else if (l == -1 &amp;&amp; r != 1) {
    if (shoot == 0) {
        if(sprite_index != runspr &amp;&amp; !boosted &amp;&amp; !sliding &amp;&amp; grounded) { sprite_index = runspr;}
    } else {
        if(sprite_index != runshootspr &amp;&amp; !boosted &amp;&amp; !sliding &amp;&amp; grounded) { sprite_index = runshootspr;}
    }
    image_xscale = -1;
    if (s == 1) { image_speed = 2/6; }
    if (runtimer &lt; maxruntimer &amp;&amp; grounded &amp;&amp; !(place_meeting(x+xspeed,y - 1,obj_wall))) runtimer++;
}
else {
    if (!boosted &amp;&amp; grounded) sprite_index = idlespr; image_index = 0;
    if (!shinesparkstored) runtimer = 0;
}
if (grounded &amp;&amp; slidetimer == -1 &amp;&amp; ss &amp;&amp; j) {
    sliding = true;
}
if (sliding) {
    slidetimer++;
    sprite_index = runspr; image_index = 0;
    xspeed = maxxspeed*2*image_xscale;
}
if (!sliding) {
    slidetimer = -1;
}
if (slidetimer == maxslidetimer) {
    sliding = false;
    if (grounded) xspeed = maxxspeed*image_xscale;
    slidetimer = -1;
}
} else {
    sstimer++;
    if (sstimer &lt; 30) { yspeed = -0.5; 
    sprite_index = jumpspr; image_index = 0;
    ssdir = 0;
    if (u) { ssdir = 0; } 
    if (r) { ssdir = 2; }
    if (ss) { ssdir = 4; }
    if (l == -1) { ssdir = 6; }
    if (u &amp;&amp; r) { ssdir = 1; }
    if (r &amp;&amp; ss) { ssdir = 3; }
    if (ss &amp;&amp; l) { ssdir = 5; }
    if (l == -1 &amp;&amp; u) { ssdir = 7; }
    }
    if (sstimer == 30) { yspeed = 0; }
    if (sstimer &gt; 30) { 
    if (ssdir == 0) { yspeed = -16; }
    if (ssdir == 1) { yspeed = -16;  xspeed = 16; }
    if (ssdir == 2) { xspeed = 16; }
    if (ssdir == 3) { yspeed = 16;   xspeed = 16; }
    if (ssdir == 4) { yspeed = 16; }
    if (ssdir == 5) { yspeed = 16;  xspeed = -16; }
    if (ssdir == 6) { xspeed = -16; }
    if (ssdir == 7)  { yspeed = -16;  xspeed = -16; }
    }
    if (sstimer == maxsstimer) { shinesparking = false; sstimer = 0; }
}

//Collision
// if (boosted ^^ shinesparkstored) { sprite_index = spr_santahat_shinespark; image_speed = 1; }
if (place_meeting(x+xspeed,y-1,obj_wall)) {
    while(!place_meeting(x+sign(xspeed),y - 1,obj_wall)) {
        x += sign(xspeed);
        sliding = false;
        shinesparking = false;
        sstimer = 0; 
        if (!grounded) shinesparkstored = false;
    }
    if (!grounded &amp;&amp; !slid &amp;&amp; !place_meeting(x,y + -abs(yspeed),obj_wall)) { yspeed -= abs(l+r+xspeed)/2; slid = true; sliding = false; }
    if (place_meeting(x+xspeed,y+yspeed,obj_wall)) { xspeed = 0; sliding = false;}
    if (sstimer &gt; 30) { shinesparking = false; shinesparkstored = false; boosted = false; sstimer = 0;}
}
if (place_meeting(x+l+r,y,obj_wall)) { wallsliding = true; slid = true;}
else { wallsliding = false; slid = false;}

if (place_meeting(x,y - sprite_height/2 + yspeed,obj_wall) &amp;&amp; yspeed &lt; 0) { wallsliding = false; slid = false;}

grounded = false;
if (place_meeting(x, y + 1 + yspeed, obj_wall) &amp;&amp; yspeed &gt;= 0) {
        grounded = true; 
}

//To prevent diagonal getting-stuck-ness
if (place_meeting(x + xspeed, y - 1 + yspeed, obj_wall) &amp;&amp; yspeed &lt;= 0) {
    xspeed = 0;
    if (sstimer &gt; 30) { shinesparking = false; sstimer = 0; shinesparkstored = false; boosted = false; }
    yspeed = 0;
    jumptimer = maxjumptimer;
}

if (place_meeting(x,y+yspeed,obj_wall)) {
    while(!place_meeting(x,y+sign(yspeed),obj_wall)) {
        y += sign(yspeed);
    }
    if (sstimer &gt; 30) { shinesparking = false; sstimer = 0; shinesparkstored = false; boosted = false; }
    yspeed = 0;
    jumptimer = maxjumptimer;
} else {
    if (!shinesparking) {
    if (wallsliding &amp;&amp; !place_meeting(x,y - sprite_height/2 - 1,obj_wall)) { maxgrav = normalmaxgrav/4; } else { maxgrav = normalmaxgrav; }
        if(yspeed &lt; maxgrav) {
            yspeed += g;    
        }
    }
}

//Jumping
if(!shinesparking &amp;&amp; j == 1 &amp;&amp; (slidetimer &gt;= 5 || slidetimer == -1) &amp;&amp; (grounded || slid) &amp;&amp; !place_meeting(x,y - sprite_height/2 + yspeed,obj_wall)) {
        if (!shinesparkstored) runtimer = 0;
        if (!slid) yspeed = -10;
        audio_play_sound(snd_pew, 1, 0);
    if (slid &amp;&amp; !grounded &amp;&amp; !boosted) { xspeed -= (l+r)*maxxspeed*2; }
    if (slidetimer &gt;= 5) { xspeed = 8*image_xscale;
    sprite_index = jumpspr; image_index = 0; }
}

//Walljump
if (!shinesparking &amp;&amp; j == 1 &amp;&amp; (slidetimer &gt;= 5 || slidetimer == -1) &amp;&amp; (grounded == true || slid == true) &amp;&amp; wallsliding) {
    yspeed = -10;
    grav = 0;
    if (slidetimer &gt;= 5) { xspeed = 8*image_xscale;
    sprite_index = jumpspr; image_index = 0; }
}


if (j2 == 1 &amp;&amp; jumptimer &lt; maxjumptimer) {
    jumptimer++;
    if (yspeed &gt; -5 &amp;&amp; !place_meeting(x, y - 1 - yspeed, obj_wall)) yspeed = -5;
}

if (!grounded) { 
    if (yspeed &lt;= 0) sprite_index = jumpspr; image_index = 0; 
    if (yspeed &gt; 0) sprite_index = fallspr; image_index = 0; 
} 
    //if (place_meeting(x,y+-abs(yspeed) - 1,obj_wall)) { grounded = false; wallsliding = false; slid = false;}

//Shooting
if (shoot == 1 &amp;&amp; !boosted &amp;&amp; !sliding) {
    if (instance_number(bullet) &lt; bulletlimit) 
        { shoottimer++; }
    else {
        shoottimer = 1;
    }
    if (shoottimer &lt; 0) {
        if (xspeed == 0) {
            sprite_index = smearspr; framenum = 0;
        }
    } else {
        if (shoottimer mod firerate == 0) {
            event_user(EV_SHOOT);
            framenum = 1;
            screenShake(5, 1);
        }
        if (shoottimer mod (firerate - 2) == 0) {
            framenum = 0;
        }
        if !((r == 1 &amp;&amp; l != -1) || (r != 1 &amp;&amp; l == -1)) {
            image_index = framenum;
            sprite_index = shootspr;
        }
        
        if (!grounded) { 
            if (yspeed &lt;= 0) sprite_index = jumpshootspr; //image_index = 0; 
            if (yspeed &gt; 0) sprite_index = fallshootspr; //image_index = 0; 
        } 
    }
} else {
    framenum = 0;
    shoottimer = -maxshoottimer;
}

if (wallsliding &amp;&amp; !grounded) {
    sprite_index = wallslidespr;
}

//Inventory system
if(collecting == true) {
    if (items &lt; maxitems) {
        global.inventory[currentemptyslot] = collecteditem;
        didyoudothething = true;
        collecting = false; 
        items += 1;
    }
    else {
        full = true;
        collecting = false;
    }
}
for(i = 0; i &lt; maxitems; i += 1) {
    j -= 1
    if (global.inventory[i] == -1) {
        currentemptyslot = i;
    }
}
j = maxitems;

if (one == 1) {
    currentslot = 0;
}
if (two == 1) {
    currentslot = 1;
}
if (three == 1) {
    currentslot = 2;
}
if (four == 1) {
    currentslot = 3;
}
if (five == 1) {
    currentslot = 4;
}
if (six == 1) {
    currentslot = 5;
}
if (seven == 1) {
    currentslot = 6;
}
if (eight == 1) {
    currentslot = 7;
}

/*
if (shoot == 1) {
    if (global.inventory[currentslot] != -1) {
        useitem = collecteditem;
        global.inventory[currentslot] = -1;
        items -= 1;
    }
}
*/

if (y &gt; room_height &amp;&amp; !hollered) { audio_play_sound(snd_goofyholler, 11, 0); hollered = true; }
footAngle -= xspeed*1.2;

//Hurt
if (iF &gt; 60) {
    sprite_index = hurtspr;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="12">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Shoot event
framenum = 1;
playSFX(snd_handgun);

//Placeholder
var p_peashooter = part_type_create(); 
part_type_color_rgb(p_peashooter, 0, 0, 255, 255, 50, 50); 
part_type_direction(p_peashooter, 0, 360, 0, 0);
part_type_life(p_peashooter, 10, 15);
part_type_gravity(p_peashooter, 0.07, 270);
part_type_alpha3(p_peashooter, 1, 1, 0);
part_type_speed(p_peashooter, 0.5, 0.8, 0, 0);
part_type_sprite(p_peashooter, spr_pixel, false, false, false);
var p_flare = createSimpleParticle(pt_shape_flare, 0.2, 5, 7, c_white);
part_type_alpha3(p_flare, 1, 1, 0);
part_type_size(p_flare, 0.2, 0.3, -0.04, 0);

if (wallsliding &amp;&amp; !grounded) image_xscale = -image_xscale;
b = instance_create(x + (sprite_width*0.3) - framenum*image_xscale + sprite_get_width(weaponspr)*image_xscale, y, bullet);
b.yspeed = 0;
b.xspeed = 10*image_xscale;
b.lifeTime = 20;
part_particles_create(SNAME, x + (sprite_width*0.3) - framenum*image_xscale + sprite_get_width(weaponspr)*image_xscale, y, p_peashooter, 3);
part_particles_create(SNAME, x + (sprite_width*0.3) - framenum*image_xscale + sprite_get_width(weaponspr)*image_xscale, y, p_flare, 1);
if (wallsliding &amp;&amp; !grounded) image_xscale = -image_xscale;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (hp &lt;= 0) {
    instance_destroy();
}
iFrames = 120; //Hardcoding this because reasons
iF = iFrames;
xspeed += -image_xscale*7;
yspeed -= 2;
collidedEntity = noone;
playSFX(snd_hit);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (textcache != "This message shouldn't appear.  ") {
    draw_set_font(font_gamefont);
    draw_text(20, 120, textcache);
}
if (didyoudothething == true) {
    fadetime = 255;
    draw_set_font(font_gamefont);
    textcache = "You got the " + collecteditemname + "!  ";  
    fading = true
    didyoudothething = false;
}
if (full == true) {
    fadetime = 255;
    draw_set_font(font_gamefont);
    draw_text_color(600, y/2, "I can't pick up anything else.  ", c_black, c_black, c_black, c_black, fadetime);  
    fading = true;
}
if (fading == true) {
    fadetime -= 255/180;
}

//Healthbar
draw_rectangle_colour(view_wview[0]/7 + sprite_get_width(spr_redhpicon)/2.2, sprite_get_height(spr_redhpicon)*1.2, (hp/maxhp)*healthbarSize + view_wview[0]/7 + sprite_get_height(spr_redhpicon)/2.2, 10 + sprite_get_height(spr_redhpicon)*1.2, c_red, c_red, c_red, c_red, false);
draw_sprite(spr_redhpbar, -1, view_wview[0]/7 + sprite_get_width(spr_redhpicon)/2.2, sprite_get_height(spr_redhpbar)*1.2 + 10);
draw_sprite(spr_redhpicon, -1, view_wview[0]/7, sprite_get_height(spr_redhpicon)*1.2);

if (fadetime &lt;= 0) { 
    full = false;
    fading = false;
    fadetime = 255;
    textcache = "This message shouldn't appear.  ";
}

//-----------------------------------------------------------------------------------
//The long, long list of item interactions and stuff
//===================================================================================
if (useitem == 0) {
    fadetime = 255;
    textcache = "You deployed the Generic Object.  ";  
    object = instance_create(x, y, obj_peashooterbullet);
    object.image_xscale = image_xscale;
    useitem = -1;
    fading = true;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

draw_set_color(c_black);
draw_text(x, y - sprite_height*2, iF);
draw_text(x, y - sprite_height*3, sprite_get_name(sprite_index)); 
//draw_text(x, y - sprite_height*4, shinesparking);
//draw_text(x, y - sprite_height*3, ssdir);
//draw_text(x, y - sprite_height*2, sstimer);

for(i = y; i &lt; y + yspeed + 1; i++) {
    draw_point(x,i);
}


if (shoot == 1) {
    if (wallsliding &amp;&amp; !grounded) image_xscale = -image_xscale;
    draw_sprite_ext(weaponspr, -1, x + (sprite_width*0.3) - framenum*image_xscale, y, image_xscale, image_yscale, image_angle, image_blend, image_alpha);
    if (wallsliding &amp;&amp; !grounded) image_xscale = -image_xscale;
}

if (boosted || shinesparking || sliding) {
    if (timer % (maxsstimer/100) == 0) {
        part_particles_create(SNAME, x, y, sspart, 1);
    }
}

//feet
/*
draw_line(x, y, x + lengthdir_x(sprite_height/2, footAngle - 270), y + lengthdir_y(sprite_height/2, footAngle - 270));
draw_line(x, y, x + lengthdir_x(sprite_height/2, footAngle - 180), y + lengthdir_y(sprite_height/2, footAngle - 180));
draw_line(x, y, x + lengthdir_x(sprite_height/2, footAngle - 90), y + lengthdir_y(sprite_height/2, footAngle - 90));
draw_line(x, y, x + lengthdir_x(sprite_height/2, footAngle), y + lengthdir_y(sprite_height/2, footAngle));
*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
